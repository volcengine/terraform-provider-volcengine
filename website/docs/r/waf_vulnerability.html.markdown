---
subcategory: "WAF"
layout: "volcengine"
page_title: "Volcengine: volcengine_waf_vulnerability"
sidebar_current: "docs-volcengine-resource-waf_vulnerability"
description: |-
  Provides a resource to manage waf vulnerability
---
# volcengine_waf_vulnerability
Provides a resource to manage waf vulnerability
## Example Usage
```hcl
resource "volcengine_waf_vulnerability" "foo" {
  host      = "www.tf-test.com"
  rule_mode = "custom"
  action    = "block"
  advance_config {
    auto_traversal {
      rule_tag = "N000000000001"
      enable   = true
      rule {
        action                           = 2
        count_time                       = 5
        effect_time                      = 60
        effect_time_view_unit            = "s"
        field                            = "CLIENTIP"
        hit_request_count                = 30
        response_http_status             = [404, 400]
        response_http_status_hit_percent = 60
      }
    }
    freq_scan {
      rule_tag = "P000000000001"
      enable   = true
      rule {
        action                = 2
        count_time            = 5
        effect_time           = 60
        effect_time_view_unit = "s"
        field                 = "CLIENTIP"
        hit_request_count     = 20
      }
    }
  }
  system_rule_switch {
    rule_id                   = 48279
    custom_system_rule_switch = 1
  }
  system_rule_switch {
    rule_id                   = 47792
    custom_system_rule_switch = 1
  }
}
```
## Argument Reference
The following arguments are supported:
* `host` - (Required) Protect website domain names.
* `action` - (Optional) Protection mode.
* `advance_config` - (Optional) The advanced configuration of vulnerability protection currently supports automatic blocking of directory traversal attacks and high-frequency scanning attacks.
* `rule_mode` - (Optional) The enabled vulnerability rule categories, WAF has classified the managed rules according to their strictness.
* `system_rule_switch` - (Optional) Custom rule switch.

The `advance_config` object supports the following:

* `auto_traversal` - (Required) Configuration of the automatic blocking capability for directory traversal.
* `freq_scan` - (Required) Configuration of high-frequency scanning automatic blocking capability.

The `auto_traversal` object supports the following:

* `enable` - (Optional) Rule switch, controlling whether the current rule takes effect.
* `rule_tag` - (Optional) Directory traversal automatically blocks the rule label, that is, the complete rule ID.
* `rule` - (Optional) Rule detail.

The `freq_scan` object supports the following:

* `enable` - (Optional) Rule switch, controlling whether the current rule takes effect.
* `rule_tag` - (Optional) Directory traversal automatically blocks the rule label, that is, the complete rule ID.
* `rule` - (Optional) Rule detail.

The `rule` object supports the following:

* `action` - (Required) Disposal action.
* `count_time` - (Required) Disposal action.
* `effect_time_view_unit` - (Required) The body records the units displayed at the front end of the length: s, min, hour, and day.
* `effect_time` - (Required) Ban time (seconds).
* `field` - (Required) statistical object.
* `hit_request_count` - (Required) The number of request triggers.

The `rule` object supports the following:

* `action` - (Required) Disposal action.
* `count_time` - (Required) Disposal action.
* `effect_time_view_unit` - (Required) The body records the units displayed at the front end of the length: s, min, hour, and day.
* `effect_time` - (Required) Ban time (seconds).
* `field` - (Required) statistical object.
* `hit_request_count` - (Required) The number of request triggers.
* `response_http_status_hit_percent` - (Required) Hit percentage: 0-99.
* `response_http_status` - (Required) Response status code.

The `system_rule_switch` object supports the following:

* `custom_system_rule_switch` - (Optional) Custom rule switch.
* `rule_id` - (Optional) The ID of rule.

## Attributes Reference
In addition to all arguments above, the following attributes are exported:
* `id` - ID of the resource.
* `rule_detail` - Detailed information of the vulnerability rules. By default, only the vulnerability protection rules of the custom mode are displayed.
    * `accuracy` - The accuracy of the rules. Only when updating the custom vulnerability rules.
    * `cve_id` - The ID of CVE. Only when updating the custom vulnerability rules.
    * `description` - The description of the rules. Only when updating the custom vulnerability rules.
    * `risk_level` - Risk grade. Only when updating the custom vulnerability rules.
    * `rule_name` - The name of rule. Only when updating the custom vulnerability rules.
    * `rule_set_name` - First-level rule category. Only when updating the custom vulnerability rules.
    * `rule_tag` - Rule label, that is, the complete rule ID. Only when updating the custom vulnerability rules.
    * `subcategory` - Secondary rule category. Only when updating the custom vulnerability rules.
    * `update_time` - The update time of the rules. Only when updating the custom vulnerability rules.


## Import
WafVulnerability can be imported using the id, e.g.
```
$ terraform import volcengine_waf_vulnerability.default resource_id
```

